<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
once upon
<div id="1">
a time<sup>2</sup>

<!-- there was a man-->
who said&gt;   
</div>    
      some stuff   





<script>

function blah (node) {
  var strs = [];
  var sel = window.getSelection();
  sel.removeAllRanges();
  var descend = function (node) {
    if (node.nodeName === "#text") {
      var range = new Range();
      range.selectNodeContents(node);
      sel.addRange(range);
      var text = sel.toString();
      sel.removeAllRanges();
      if (text.trim() !== "") {
        node.blah = text;
        console.log(node);
      }
    } else {
      var kids = node.childNodes;
      var len = kids.length;
      for (var i=0; i<len; i++)
        descend(kids[i]);
    }
  };
  descend(node);
  return strs;
}




</script>
</body>

</html>